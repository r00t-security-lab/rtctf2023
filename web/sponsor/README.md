## [AD] Message From Our Sponsor

*Easter-egg special*, by EZForever

~~这题也勉强能算web吧~~

### 题目描述

This challenge is brought to you by...

No, seriously.

---

鲸鱼云（WhaleCloud）作为本次新生赛的域名与安全审计赞助商，其“运营者”联系我们，要我们出一道题为他们做宣传。我们联系他索要宣传文案，却得到了这样的回复：

“宣传文案已经写好了，就放在我们的域名里，请自取。”

这里的“域名”应该指的就是比赛平台的域名了。不过我们总觉得这是他在整我们；文案“放在域名里”是几个意思？

这是一道附加题，纯纯整活，做不出也没关系，反正分数也微不足道。两问都不遵守flag格式。

1. 这位“运营者”的真名是什么？（肯定和鲸鱼无关就是了）
2. 域名里隐藏的文案是什么？（提示：`[0-9A-Za-z+/]+`）

**免责声明：鲸鱼云并不是真实存在的组织、企业或提供商，不对外提供任何（与网络相关或无关的）资源或服务，与r00t信息安全战队也没有任何形式的财务往来。`*.whalecloud.online`只是从学长名字neta出来的一个域名。**

**注意：本题所需的所有信息只与题干和其中提及的域名有关（包括子域名，不包括域名上的网站）。对计算机信息系统的未授权访问或破坏需承担刑事责任。**

---

**另一条提示：**
- 你知道吗？在国内不止使用网站服务要实名，开网站也是要实名的。
- 域名是为了方便表示IP地址而被发明出来的，但域名里不止能存储IP地址。不妨去百度看看，或者问问ChatGPT。

### 解析

配homelab和比赛平台救火而有感而发的一次整活。

*众所周知*，在国内提供互联网服务是要遵守备案制度的，具体而言是在开设服务之前需要提前将域名向有关部门报备，等审核通过拿到备案号方能实际使用这个域名。如果你试过购买国内的云服务器假设博客，那么在配置域名解析的时候大概率会在这碰个钉子，因为国内的云服务厂商基本都要求绑定备案，从未备案域名访问你的网站（检查方式可能是Host头和SNI？）则会被云服务商拦截。

这里的关键是，备案信息是[公开可查](https://beian.miit.gov.cn/)的，而且相关规定要求通过备案的网站应在其页面底部标注其备案号。比赛平台域名的备案号标在了根域名上笔记网站的页面下面，拿去查询就能得到备案实体的名称——个人备案是姓名，企业备案是法人名称——从而得到第一问答案。没自己搭过网站的同学可能对其中涉及的规定不甚了解，因此后面的提示尝试从“实名”的角度指引搜索方向。至于为什么还是没人做……想必是被免责声明吓跑了吧……

第二问则需要一些DNS上的知识。DNS（Domain Name System，域名系统）服务主要负责将便于用户记忆的域名翻译成其实际对应的主机的IP地址，可以说是当今互联网的基石，~~从《流浪地球2》中拯救地球需要先重启DNS根服务器也可见一斑~~。DNS服务器通过存储和查询关于域名的一系列记录（records）实现它的功能，最常用的记录类型有`A`（IP地址）、`AAAA`（IPv6地址）和`CNAME`（域名别名，可以理解为DNS跳转）等。

不过随着DNS的普及，其标准的设定者心思便开始活络了起来。DNS服务的工作原理允许你从任意公开DNS服务器查询得到任何公开注册的域名的IP地址，那为什么不能利用这套服务使用域名传达其他信息呢？于是`TXT`等一系列“辅助”记录类型便被实现出来了。这里的`TXT`和Windows上的TXT文件是一个意思，单纯代表“任意文本”，也就是说可以使用`TXT`记录在DNS服务器中存储任意文本，之后可以通过查询域名的`TXT`记录将这些文本取出。本题中的“宣传文案”便放在比赛平台域名的一个`TXT`记录中，可以通过`nslookup -qt=TXT ***.***`（Windows）或`dig ***.*** TXT`（Linux）命令查询得到。

```
C:\Users\EZForever>nslookup -qt=TXT ***.***
服务器:  ***.local
Address:  ***:***::***

非权威应答:
***.***  text =

        "base64(35ebdeafe8289e76be822bdefb2a2efaea7f35ebdeafe8289e76be95eb7eca8bbe768c27)"

```

这里还有一个知识点（话说都明示了还能算知识点吗……）：Base64编码的码表恰好包括完整的大小写英文字母与数字范围，所以可以通过构造长度为4的倍数的字符串，将纯英文和数字的字符串通过Base64*解码*变成更短的二进制状态，并可以通过Base64*编码*还原，我愿将其称之为“Base64反用”。题目文本中的提示也是在讲Base64的这个特点：`[...]+`是[正则表达式](https://deerchao.cn/tutorials/regex/regex.htm)的写法，表示“一个由方括号内的字符组成的（非空）字符串”，而方括号内的`0-9`、`A-Z`、`a-z`、`+`和`/`正是Base64码表的所有字符。总之，使用Base64编码后面的二进制数据（当然要先解十六进制），即可得到flag：`Never+gonna+give+you+up/Never+gonna+let+you+down`。

~~所以这的确是赞助商在整我们~~

~~所以一个TXT一个Base64居然直到现在都没人整明白，我不李姐（~~

### 花絮

1. 看过视频的小伙伴应该一眼就认得出，题目名称和开头是在cue[某加拿大白嫖王](https://www.bilibili.com/video/BV1bY4y1v7Mb/)。不过鄙人不但没白嫖成，[还被嫖了一道题](https://github.com/r00t-security-lab/rtctf2023/blob/main/koali/README.md)。惨惨。
2. “鲸鱼云”是虚构的，但是“域名与安全审计赞助”是真事。就在本次新生赛开赛前，我们举办往届新生赛使用的域名备案出了问题，以至于没法正常从国内访问。出于救火，我们把平台迁移到了我的个人域名下。这也就是本次比赛没有使用`r00team.cc`域名的原因，以及本题第一问的来源。至于安全审计……直接去花絮总集文档里看吧……pyy真不柿个好人钠（
3. 这道题的分数低的离谱，是因为开赛时我固执地认为彩蛋不应该影响正常题目。不过实践结果表示这次比赛变成了彩蛋导向，分数低的彩蛋直接没人做了。事后再看，这道题应该至少值个一两百分的……

